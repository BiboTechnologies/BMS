import{initializeApp}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-app.js";import{getStorage,ref as storageRef,uploadBytes,getDownloadURL}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-storage.js";import{getDatabase,ref,remove,push,get,update,onValue,child,set}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-database.js";import{getAuth,onAuthStateChanged,sendPasswordResetEmail,signInWithEmailAndPassword,GoogleAuthProvider,signInWithPopup}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-auth.js";const firebaseConfig={apiKey:"AIzaSyCi_hufIZTzsYtdPGQtvtmKmAkkrydmn_A",authDomain:"abbah-83a7b.firebaseapp.com",databaseURL:"https://abbah-83a7b-default-rtdb.firebaseio.com",projectId:"abbah-83a7b",storageBucket:"abbah-83a7b.appspot.com",messagingSenderId:"379729759051",appId:"1:379729759051:web:e75528d61b02d1e4f536ce",measurementId:"G-H41J2WMR6S"};const app=initializeApp(firebaseConfig);const database=getDatabase(app);const auth=getAuth(app);const storage=getStorage(app);const loginForm=document.getElementById("loginForm");let authToken;loginForm.addEventListener("submit",async e=>{e.preventDefault();const email=document.getElementById("email").value;const password=document.getElementById("password").value;const loginBtn=document.getElementById("loginBtn");try{loginBtn.innerHTML='<i class="fa fa-spinner fa-spin"></i> Logging in...';const userCredential=await signInWithEmailAndPassword(auth,email,password);authToken=Math.random().toString(36).substring(2);const currentTime=new Date;const tokenExpiryTime=new Date(currentTime.getTime()+24*60*60*1e3);localStorage.setItem("authToken",authToken);localStorage.setItem("tokenExpiryTime",tokenExpiryTime.toString());console.log("Generated Token:",authToken);const storedLogoutPage=localStorage.getItem("logoutPage");window.location.href=storedLogoutPage||"index.html"}catch(error){console.error("Login error",error);loginBtn.innerHTML="Login";const errorContainer=document.createElement("p");errorContainer.classList.add("error-message");errorContainer.textContent="Incorrect email or password, try again...";loginForm.appendChild(errorContainer);setTimeout(()=>{errorContainer.style.display="none"},5e3)}});document.getElementById("forgotPasswordLink").addEventListener("click",function(event){event.preventDefault();const email=document.getElementById("email").value;sendPasswordResetEmail(auth,email).then(()=>{alert(" A password reset email has been sent. Please check your inbox.")}).catch(error=>{const errorMessage=error.message;alert("Password reset email failed to send. "+errorMessage)})});const termsLink=document.getElementById("termsLink");const termsModal=document.getElementById("termsModal");termsLink.addEventListener("click",function(event){event.preventDefault();termsModal.style.display="block"});const closeBtn=document.querySelector(".close");window.addEventListener("click",function(event){if(event.target===termsModal){termsModal.style.display="none"}});closeBtn.addEventListener("click",function(){termsModal.style.display="none"});